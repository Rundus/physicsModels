# # --- parameterizationCurves_Evans1974_classes.py ---
# # --- Author: C. Feltman ---
# # DESCRIPTION: Provides needed functions and data needed for the Evans 1974 model

# TODO: Fix the "V0" guess on the secondaries calculation to make sense. Like, energy beams above V0 COULD have secondaries above
# V0, but NOT above the E_mono beam that produced those secondaries.


# --- Imports ---
import numpy as np
from scipy.interpolate import CubicSpline
from scipy.integrate import simpson
from src.physicsModels.invertedV_fitting.primaryBeam_fitting.primaryBeam_classes import helperFuncs


class Evans1974():

    #################################
    # --- PARAMETERIZE THE CURVES ---
    #################################
    def __init__(self):
        # --- EVANs - Secondary Electron Backscatter Curves ---
        # Secondaries data
        self.Energy_secondaries = [10.17496576561469, 10.718446060311226, 11.290955526950686, 11.997646044427388,
                              12.85961219779013, 13.546488791572546, 14.270053852147703, 15.032267038074046,
                              15.97312280060254, 17.12070551529857, 18.350735858020062, 19.499291530622624,
                              20.540816480342805, 21.826447283974872, 22.79373225515666, 23.803884496641345,
                              24.64414455946939, 25.960473995484463, 27.110967065377004, 28.31244665824677,
                              29.311855734157486, 30.610872342779636, 31.691414198105562, 32.81009840651562,
                              33.96827136573758, 35.47364683805397, 36.7258411479822, 38.022237019621116, 39.70727251629559,
                              41.46698390917224, 43.3046806178358, 46.82018711552433, 45.22381872576847, 48.89512229647873,
                              51.06201259915312, 53.78941220859147, 56.173203274592055, 58.66263706121415,
                              62.33427753861964, 65.6637680063783, 69.17109813495638, 73.50045352199562, 77.4263682681127,
                              81.56197976921872, 85.17657064716352, 89.72614740082682, 95.34202440844852,
                              102.19183459028312, 107.65025574452392, 114.3879862011722, 119.45733067563364,
                              126.93405508837688, 133.71404425547448, 139.63986368735334, 148.37979427108883,
                              156.30527492380824, 163.23227231294564, 178.02082518094767, 171.95107545235493,
                              189.16298482974503, 201.00252199891452, 211.73876548190316, 223.04846905374944,
                              234.96226321142643, 249.66833507399298, 267.60565824583045, 286.8316813342009,
                              302.15235860140325, 321.0637967119472, 344.13049869757356, 365.66930997210375,
                              385.2009790629936, 409.3103539141118, 434.9287123538119, 454.2034940680203, 470.2365518874762,
                              486.8355651572963, 499.66822499934193, 512.8391451707628, 530.9419994508138,
                              549.6838715128936, 564.1731706697959, 584.0880792596014, 594.3076210570079, 609.9731724020412,
                              620.6456147134156, 642.5539601049684, 653.7964546628194, 682.7708212456762, 700.7682033726139,
                              719.239984453556, 738.1986693275925, 751.1146188630573, 764.2565532984336, 784.4018448146026,
                              798.1261917473589, 826.2994743104199, 840.7568863253938, 862.9186754473221, 885.6646345059752,
                              901.1607335913945, 932.9710616381673, 949.2948612477545, 982.8042895037572]
        self.NFlux_up_PeriE_secondaries = [0.01, 0.00962040327106476, 0.008903890941296734, 0.008082822192522706,
                                      0.007337467970651373, 0.0067909850299557074, 0.006285203269240097,
                                      0.005817091329374358, 0.005383843622033489, 0.004887374631624418,
                                      0.004436687330978606, 0.004027559979850294, 0.003586095482011829,
                                      0.003255405118685032, 0.002898577214651068, 0.0025808615404180717,
                                      0.0022979709690469606, 0.0020068781676649667, 0.0017190722018585747,
                                      0.0014725404276241208, 0.0012613637220374424, 0.0010597662486760708,
                                      0.0009620403271064761, 0.0008240743309893649, 0.0007337467970651374,
                                      0.000653320145959377, 0.0005817091329374357, 0.0005280670574582637,
                                      0.0004701851489299847, 0.00041864772882899473, 0.0003727593720314938,
                                      0.0003071814301268697, 0.00033190087959146774, 0.0002788548171726292,
                                      0.0002580861540418071, 0.00022979709690469603, 0.0002126821747296208,
                                      0.00019306977288832496, 0.00017526592085367583, 0.0001622123939129173,
                                      0.00015013107289081742, 0.00013628679593557727, 0.00012613637220374423,
                                      0.00011674193588234575, 0.00010804718223181286, 0.00009808365445406671,
                                      0.00008733261623828437, 0.00007626985859023451, 0.0000692366640267872,
                                      0.00006164757056337162, 0.00005489032450921557, 0.00004982863514647296,
                                      0.00004436687330978606, 0.000039503780135666406, 0.00003586095482011829,
                                      0.00003131831005243845, 0.00002843030459302665, 0.000023886430789846003,
                                      0.000025808615404180768, 0.00002168375310987433, 0.000019306977288832496,
                                      0.000017526592085367586, 0.000015910384392721502, 0.000014443214647272789,
                                      0.000013628679593557728, 0.00001213482767749143, 0.000011015819387358994,
                                      0.000010195378685327302, 0.00000943604310147889, 0.000008733261623828437,
                                      0.000008082822192522723, 0.000007337467970651388, 0.000006408002744415996,
                                      0.000005705615758781021, 0.000005080218046913012, 0.000004436687330978607,
                                      0.0000039503780135666406, 0.0000033838551534282333, 0.000002955209235202888,
                                      0.0000025314033152415694, 0.000002168375310987433, 0.0000018574090746385719,
                                      0.0000016221239391291696, 0.0000014443214647272788, 0.0000012860080806105652,
                                      0.0000011450475699382812, 9.80836544540667e-7, 8.565902153685499e-7,
                                      7.480826455225093e-7, 6.53320145959377e-7, 5.705615758781021e-7, 5.080218046913023e-7,
                                      4.4366873309786064e-7, 3.9503780135666407e-7, 3.51737350096938e-7,
                                      3.0718143012686963e-7, 2.843030459302665e-7, 2.4353120734334173e-7,
                                      2.1268217472962083e-7, 1.8936988889503602e-7, 1.6861288382868804e-7,
                                      1.4725404276241208e-7, 1.286008080610565e-7, 1.1231045018329516e-7]
        self.Energy_secondaries, self.NFlux_up_PeriE_secondaries = zip(*sorted(zip(self.Energy_secondaries,self.NFlux_up_PeriE_secondaries)))

        # backscatter curves data
        self.Energy_BackScatter = [1, 0.9582558549602653, 0.9261187281287937, 0.8874586936177703, 0.8576958985908941,
                                  0.8289312615337154, 0.8011313071180073, 0.767688765637801, 0.7356422544596414,
                                  0.6989473207273487, 0.6697703623957719, 0.6363612169654032, 0.5994842503189411,
                                  0.5695810810737686, 0.5365740058950261, 0.5098088935466992, 0.48437886495410437,
                                  0.46021732414665023, 0.4372609970601657, 0.4119218362588828, 0.3913745601980384,
                                  0.37185221293765525, 0.3533036694992736, 0.33568035509467253, 0.3189361179185748,
                                  0.3030271082866398, 0.29037750072735075, 0.27355020025126336, 0.2576980374514879,
                                  0.24276450335386565, 0.23065504755640526, 0.2172886476740597, 0.2046968271807521,
                                  0.192834699402793, 0.1801173528334133, 0.1711328304161781, 0.16121572750178864,
                                  0.15187331811625285, 0.14429765031006772, 0.13709986812211702, 0.13026112205370022,
                                  0.12271252398511903, 0.11659144011798317, 0.10983499655437803, 0.10347008713411984,
                                  0.09830884473994818, 0.09340505282049072, 0.08950593874810804, 0.08504124891946163,
                                  0.08149127469020741, 0.07808949110006652, 0.07419427072122865, 0.07170600970409613,
                                  0.06930119775694155, 0.06584435056818477, 0.06309573444801933, 0.060461856957832634,
                                  0.05793792843161315, 0.05551935914386209, 0.05320175096324757, 0.05098088935466992,
                                  0.048437886495410414, 0.046415888336127795, 0.04447829676127633, 0.04262158829015325,
                                  0.04084238652674522, 0.03913745601980384, 0.037503696379226896, 0.03593813663804628,
                                  0.034145488738336005, 0.03300034791125285, 0.03189361179185748, 0.030823992397451434,
                                  0.02953727118810853, 0.02830426305555415, 0.027122725793320285, 0.02599051079393097,
                                  0.024694065319965788, 0.023865897868585808, 0.023065504755640526, 0.022102654979706378,
                                  0.021000141557086554, 0.0199526231496888, 0.019119717955005014, 0.018321581675572463,
                                  0.01740767383330236, 0.016681005372000592, 0.015984671064343196, 0.015187331811625286,
                                  0.014677992676220698, 0.01406527242105237, 0.013478129649084574, 0.012805820423628654,
                                  0.012271252398511897, 0.011659144011798317, 0.011077568505097092, 0.010615144878732719,
                                  0.01008564560714737]
        self.NFlux_up_PeriE_BackScatter = [0.00011659144011798335, 0.0001081230103192746, 0.00010026967115829288,
                                          0.00009125021956617401, 0.00008462240814424688, 0.0000770104582390694,
                                          0.00007141692874235842, 0.0000662296761714834, 0.00006141919126211213,
                                          0.000058042042927286296, 0.00005382625345418286, 0.00004898447745345474,
                                          0.0000454265695305298, 0.00004212708446819444, 0.0000383376714314434,
                                          0.000035553076963491, 0.000032970736989915416, 0.00003115783344567483,
                                          0.000028894734843002547, 0.000026796012729932755, 0.000024849727887245227,
                                          0.00002348335989328803, 0.00002177768420652337, 0.000020580233239763535,
                                          0.000019448624389373654, 0.000018379237311466208, 0.000017368650727593748,
                                          0.00001641363147908973, 0.000015511124183259427, 0.000014658241458327077,
                                          0.000013852254685866867, 0.000013090585281163766, 0.0000123707964435753,
                                          0.000011690585360501962, 0.000011258019285837975, 0.000010638994510302386,
                                          0.000010245338593872244, 0.000009866248431789506, 0.00000950118507318144,
                                          0.00000932375049624682, 0.000008978760230238898, 0.000008646535029500377,
                                          0.000008326602570874948, 0.000007868762416533264, 0.000007436096708208832,
                                          0.000006895987907029672, 0.000006395109030978996, 0.000005930610678191438,
                                          0.000005499850408475976, 0.000005005128186391172, 0.0000045549071886755406,
                                          0.000004224068906483475, 0.000003917260525325609, 0.0000036327366723874875,
                                          0.0000034329898122952065, 0.000003124185713602668, 0.000002897265560913933,
                                          0.0000026868273847837817, 0.0000024451420451043524, 0.0000022675431258708044,
                                          0.000002102843815547939, 0.000001950107172003647, 0.0000017746912457903893,
                                          0.0000016150543227062977, 0.0000014697770507853085, 0.0000013630221830031345,
                                          0.0000012640212815719117, 0.0000011288378916846906, 0.0000010468465857176266,
                                          9.526807029019838e-7, 8.834842880970382e-7, 8.193138424413288e-7,
                                          7.59804312832608e-7, 6.914584397494283e-7, 6.292604106421371e-7,
                                          5.835551032264557e-7, 5.211455867173361e-7, 4.7426752939905745e-7,
                                          4.3981987805811335e-7, 4.078742758969022e-7, 3.7118519290075845e-7,
                                          3.4422475956860925e-7, 3.1326107414037545e-7, 2.850826323317469e-7,
                                          2.643761185749101e-7, 2.4059497342849544e-7, 2.2311974848625545e-7,
                                          2.06913808111479e-7, 1.9188495988212056e-7, 1.7794770762290308e-7,
                                          1.6502276503431532e-7, 1.5303660464837528e-7, 1.4192103954525943e-7,
                                          1.3161283545126592e-7, 1.2205335101141175e-7, 1.1318820419024433e-7,
                                          1.0496696290308788e-7, 9.734285811778847e-8]
        self.Energy_BackScatter, self.NFlux_up_PeriE_BackScatter = zip(*sorted(zip(self.Energy_BackScatter, self.NFlux_up_PeriE_BackScatter)))

        #########################
        # --- TEST MODEL 0DEG ---
        #########################
        # --- TestModel data - 0 deg - Secondaries/backScatter ---
        self.testModel_BackScatter_Energies_0deg = [10.17709639766224, 10.821999183338981, 11.208700715625968, 11.814815327351234, 12.344873903457717, 12.898712969256117, 13.359621530164212, 14.08204797565431, 14.713823428069432, 15.373942784933998, 16.20529439277789, 16.784356732987327, 17.38411065618944, 18.00529553287512, 18.648677153395127, 19.485329355255157, 20.005231584725344, 20.72007674193801, 21.08702183696625, 21.64965998724049, 22.033067666675752, 22.82037330987, 23.021556792495566, 23.635811675442397, 24.266455939204132, 24.266455939204132, 24.696206132290385, 25.13356704648566, 25.578673464919163, 26.726232259521783, 26.261156635659866, 26.96184963573291, 27.68123833482498, 28.41982156646481, 29.435344517528634, 29.95663386532876, 30.4871550596924, 31.300604994089447, 32.41906672261727, 33.284063395711016, 33.873512168405206, 35.083911359677614, 36.02001068865875, 36.657912102330435, 37.636008488706544, 38.98085262565264, 40.37375195828243, 41.816423638620286, 43.692471072086306, 45.253730246730555, 46.87077775631218, 48.545607080431246, 51.6218476912336, 53.937804591537954, 55.376958344015065, 57.35573826094496, 60.99025973285772, 64.85509375466215, 67.76474555169581, 72.69413357798709, 75.29170657412634, 80.06279543982323, 82.92367217352547, 87.40780023059995, 90.53113536585349, 94.59271427130095, 98.83651140629469, 103.27070178945473, 108.8551029529588, 113.73876632597786, 122.01242703683677, 132.04183857498546, 137.96574910615675, 148.00174505280094, 161.5795063648351, 173.33322989001613, 184.31701921838456, 201.22636371158637, 215.86410520649565, 229.54299330342528, 246.24056183256212, 264.15275595655044, 285.86609092385333, 303.98086857395595, 328.9680711458026, 356.0092197284479, 381.9062783050191, 409.68715787765825, 439.48889260160564, 488.3050688813476, 547.3265375014148, 624.3464793338119, 681.6243679788352, 731.2075394434132, 805.3266030292443, 871.5243840303639, 926.7511875394177, 1002.930059471001, 1075.88586246435, 1134.0647859928526, 1205.9282636536022, 1293.6506965355409, 1387.7542927608201, 1501.8275822932776, 1611.074519494021, 1774.3815538317454, 1774.3815538317454, 1886.8206584846582, 2006.3848102999737, 582.0095546329565, 514.7103449911729]
        self.testModel_BackScatter_Flux_0deg = [8610568.91804672, 7954940.628984377, 7414189.709243227, 7032888.918362327, 6497388.770509437, 6163237.693451454, 5744280.895813771, 5260404.108396625, 4902818.993372483, 4569541.348240764, 4258918.830474484, 4039888.945612909, 3765270.4707706654, 3509319.6642084075, 3270767.5587191326, 3075375.067612488, 2866321.100534323, 2624872.9069330576, 2468065.537740231, 2341136.5841537085, 2181993.754538096, 2033668.9354518522, 1929080.3554603024, 1829870.6111651435, 1661047.9349141, 1661047.9349141, 1575622.7008545771, 1442898.1240974318, 1321353.7704138744, 1188938.076046969, 1253398.5038978148, 1108117.9432360276, 1032791.6994670585, 954152.591955798, 881501.2448354862, 821579.6651368309, 765731.3589980473, 707426.832832643, 659338.2639362261, 619950.0336326087, 572745.6289384188, 538530.3589139892, 501922.8214761579, 476109.67448432476, 451624.05939403543, 424644.47480892565, 402805.6386801468, 378742.41934078815, 352996.7449032823, 331909.06071266386, 317622.1842578121, 298647.7421127483, 280806.81479303486, 261718.48334582668, 248258.68954482625, 235491.11299516217, 219483.19516369258, 208195.49965238877, 195758.1018294131, 184063.702125346, 173067.91455104738, 162729.0046934469, 151667.21767822717, 142606.764757211, 135272.7101512032, 126077.31249309646, 118545.57576225295, 111463.77770047661, 106665.86944880507, 101180.20183362099, 94302.30170174898, 91040.71687359674, 86358.62770301767, 83371.78660992305, 79783.0854983633, 77704.44446465117, 75679.95962858456, 75016.92112139838, 75016.92112139838, 75016.92112139838, 74359.69155047725, 73708.2200232406, 74359.69155047725, 74359.69155047725, 74359.69155047725, 74359.69155047725, 73708.2200232406, 73062.45609298225, 73708.2200232406, 73708.2200232406, 73708.2200232406, 73708.2200232406, 75679.95962858456, 75679.95962858456, 77023.6692751238, 77704.44446465117, 80488.24984151094, 81199.6467933344, 83371.78660992305, 84108.66975720416, 85602.03248447034, 87121.91010302707, 89452.47405626308, 91040.71687359674, 92657.15919321837, 96824.94548668645, 96824.94548668645, 97680.73463870949, 102074.48500304058, 73708.2200232406, 73062.45609298225]
        self.testModel_BackScatter_Energies_0deg, self.testModel_BackScatter_Flux_0deg = helperFuncs().removeDuplicates(self.testModel_BackScatter_Energies_0deg, self.testModel_BackScatter_Flux_0deg)
        self.testModel_BackScatter_Energies_0deg, self.testModel_BackScatter_Flux_0deg = zip(*sorted(zip(self.testModel_BackScatter_Energies_0deg, self.testModel_BackScatter_Flux_0deg)))

        # TestModel data - 0 deg - Primary Beam
        self.testModel_Beam_Energies_0deg = [2190.4516538674266, 2190.4516538674266, 2114.8808065014846, 2229.2437635827473, 2329.256310743216,
             2370.5066009296816, 2455.211702024791, 2498.6926168174664, 2610.793687710379, 2680.4541709477944,
             2751.9733161498525, 2800.7097722251287, 2875.43754449581, 2926.3605075791083, 3004.440858410518,
             3084.6045278112415, 3166.9071023176557, 3251.4056516108894, 3338.1587680896982, 3427.226607499209,
             3487.92155611524, 3549.6913904068865, 3644.403285400129, 3676.5321964872974, 3807.9053937864514,
             3841.475732808874, 3943.9729378358097, 4013.8192778126163, 4084.902571309405, 4157.244724327415,
             4268.1671912370175, 4343.754894655844, 4382.049261076251, 4498.969901161162, 4578.645037429808,
             4659.7311916600975, 4700.811192259024, 4826.23695102428, 4868.784859623275, 4955.009285586447,
             5087.217488365791, 5222.953234258523, 5362.3106442053595, 5409.584556672638, 5505.386350456238,
             5602.884759496707, 5702.109830239057, 5803.092141240033, 5957.928658860297, 6116.896482102679,
             6116.896482102679, 6225.224515287998, 6280.105841334056, 6391.324253477838]
        self.testModel_Beam_Flux_0deg = [630957.344480193, 630957.344480193, 665165.837925079, 588066.9220046379, 552936.3727482117,
             519904.48853292025, 488845.8971386252, 459642.715960387, 432184.10458609177, 395778.52834550856,
             372135.10178228474, 346838.5712433222, 326118.77039216075, 309346.9652525361, 285792.58417905396,
             271094.6950436425, 250452.92877047267, 229355.70863609706, 211892.04365983704, 199233.81787243593,
             187331.78225299626, 171551.6519596178, 159890.13015739655, 149021.32057444143, 136468.32061429508,
             128315.83510645616, 116477.49934878934, 109519.2461721114, 102074.48500304058, 94302.30170174898,
             86358.62770301767, 80488.24984151094, 75016.92112139838, 69917.51548350557, 64027.924882008076,
             60202.95856493234, 56110.55778741933, 50045.27238116231, 46234.7115902078, 41236.95835929143,
             37104.514348468714, 32516.35907864507, 29257.825019039014, 27030.067719667684, 24321.326679966216,
             22077.4568483865, 20217.73426728446, 18191.67176875346, 15802.511485430437, 14344.582020811311,
             13021.160183398451, 12029.69945021091, 11211.9597152078, 10449.807260416519]

        self.testModel_Beam_Energies_0deg, self.testModel_Beam_Flux_0deg = helperFuncs().removeDuplicates(self.testModel_Beam_Energies_0deg, self.testModel_Beam_Flux_0deg)
        self.testModel_Beam_Energies_0deg, self.testModel_Beam_Flux_0deg = zip(*sorted(zip(self.testModel_Beam_Energies_0deg, self.testModel_Beam_Flux_0deg)))

        ##########################
        # --- TEST MODEL 45DEG ---
        ##########################
        # TestModel data - 45 deg - Secondaries/backScatter
        self.testModel_BackScatter_Energies_45deg = [10.176192997162854, 10.723618124949738, 11.30049181671492, 11.702213442778783, 12.439894228521112,
             12.995111952420912, 13.694179946035245, 14.430854084289598, 15.340542138766223, 16.30757484877216,
             17.184835750562474, 17.951829843578437, 18.917542929883826, 19.93520625040975, 20.824954960205776,
             21.754414960501602, 22.725358646779018, 23.94786222593521, 24.157913308749997, 23.533223311126203,
             22.331886446252447, 20.64388367796982, 24.799185717885024, 25.680772941983797, 26.133250177394466,
             27.062262111199722, 28.024299526615323, 29.275080884657733, 31.12051506471799, 32.509486805426775,
             34.25832450668779, 36.417890973654245, 40.08982255692397, 42.99079477974487, 46.91396604442517,
             49.00783155226678, 53.94917767894156, 59.90965787002574, 65.37677820210325, 74.52698071700075,
             83.48687491105828, 93.52395891203355, 107.54879840697023, 120.47869097948207, 137.3410150570633,
             153.85263207920627, 175.38600799171752, 203.45590109212807, 246.55225328487467, 309.398590739151,
             388.2645024572781, 500.16701125591396, 622.2024716619097, 740.9434823919698, 859.5287936282604,
             1041.5955481985143, 1218.8973426067182, 1438.8907241083919, 1743.678843205374, 2094.6550629493527,
             2346.481818260157, 2494.3986683405465, 2628.5840665683977, 2722.0277044732097, 2226.697330017137,
             1970.442849862127, 1853.5963716650642, 1640.2793805162978, 1529.5951062449708, 1377.4139445542783,
             1307.098963563048, 1126.7644144940668, 971.3098098627014, 905.7668769487757, 794.55949573419,
             678.9822281224056, 580.2169234414307, 545.8102903846996, 470.5073061902773, 438.7579832739357,
             409.1510702466314, 362.06483477245024, 334.69740010164355, 291.0513772234006, 271.4115458347366,
             231.93180261313705, 214.40074782266913, 189.72691746525766, 164.98568739358006, 144.72923211809535,
             128.0733922606994, 114.32842881641685, 103.85678933633378, 99.41949549862142, 68.89370159099326,
             55.86701910863368, 44.51907622667727, 38.71359157421896, 35.47617502596289, 30.052188634263224,
             28.270105787113867, 51.195150526838894, 78.53613639574519, 88.74969666565254]
        self.testModel_BackScatter_Flux_45deg = [8102694.067782572, 7687529.618407574, 7357855.745854396, 6859530.891229079, 6339141.657785804,
             5858231.064876088, 5558068.026013316, 5047143.878189551, 4503532.4822710175, 4053853.223659968,
             3681203.6817674898, 3401934.0360030835, 3035522.823093931, 2756483.073250986, 2374840.8887292896,
             2175521.861321947, 1907466.20758275, 1657842.0354695553, 1505445.280835687, 1778279.410038923,
             2046038.048087438, 2569794.9844652177, 1379094.1258529664, 1263347.5505043897, 1147214.6122917442,
             1041757.168191954, 937737.358655891, 822194.5984661904, 714596.5476372021, 637629.6855554007,
             568952.6730094043, 494495.60561446304, 418627.1694221463, 370278.0080940258, 319012.0637243106,
             289686.95182553557, 263057.54421404056, 232675.82851856903, 207615.07435935654, 174227.51858113377,
             151426.9049124562, 131610.13666556944, 108525.79974793168, 96836.84002774404, 87167.64843173872,
             81264.05270587104, 77779.10548813797, 75099.06288883052, 72511.36679169758, 71878.49657993559,
             71878.49657993559, 71878.49657993559, 73149.80925001443, 73793.8730169704, 77100.25910668247,
             81264.05270587104, 84905.1454209604, 90278.37980563525, 96836.84002774404, 103871.75320101996,
             98549.59012012751, 91875.13062183322, 84905.1454209604, 81264.05270587104, 101175.68236992316,
             100292.6335686151, 97689.46152611618, 93500.12311864749, 91875.13062183322, 87935.13538189272,
             87167.64843173872, 84164.10384720816, 79851.71792487627, 78463.92892356131, 76427.33761220945,
             74443.60758662784, 73793.8730169704, 72511.36679169758, 71878.49657993559, 71878.49657993559,
             71878.49657993559, 71878.49657993559, 72511.36679169758, 73793.8730169704, 73149.80925001443,
             72511.36679169758, 73793.8730169704, 77100.25910668247, 79154.7820392537, 84164.10384720816,
             92684.06564606036, 103871.75320101996, 115393.87065151166, 120564.17372901062, 190190.06079621578,
             245241.46885099573, 342187.35702059243, 449039.2087660087, 525789.8314000103, 766509.8965766157,
             866597.1549043449, 277263.9467800957, 163857.7567886399, 142414.20160528287]

        self.testModel_BackScatter_Energies_45deg, self.testModel_BackScatter_Flux_45deg = helperFuncs().removeDuplicates(self.testModel_BackScatter_Energies_45deg, self.testModel_BackScatter_Flux_45deg)
        self.testModel_BackScatter_Energies_45deg, self.testModel_BackScatter_Flux_45deg = zip(*sorted(zip(self.testModel_BackScatter_Energies_45deg, self.testModel_BackScatter_Flux_45deg)))

        # TestModel data - 45 deg - Primary Beam
        self.testModel_Beam_Energies_45deg = [2651.6398585319253, 2745.9031076879996, 2843.5173247792095, 2918.9985628304253, 3049.2793922610904,
             3241.4989949055057, 3445.83568191239, 3631.2033374815624, 3793.27131129371, 3997.329158161811,
             4249.31165093399, 4477.902045609818, 4637.087160761734, 4844.04977086338, 5240.1365513581795,
             5474.014479540142, 5668.61043460869, 5768.487380830924, 6078.801359984899, 6185.905583062229,
             6078.801359984899, 5973.551564597568, 5768.487380830924, 5619.322329935615, 5426.418370800288,
             5104.633917170374, 4929.398535616826, 4760.178754681552, 4556.79954385158, 4362.109734308727,
             4103.438360003826, 4103.438360003826, 3893.963792519524, 3727.593720314938, 3599.6303210868728,
             3537.305475722068, 3356.7311695964954, 3298.611937226783, 3185.3749194902684, 3130.2225895070565,
             5060.24954224647, 5149.407595570507, 5332.464087810821, 5570.46278130644, 5870.124088903394,
             6078.801359984899]
        self.testModel_Beam_Flux_45deg = [407761.38093006687, 386868.5732078371, 351305.76700235356, 321820.87640028686, 292237.5650307329,
             243101.03174172968, 202226.26624909928, 162427.62661973038, 141171.22812518332, 119511.90458094755,
             93500.12311864749, 76427.33761220945, 60850.47313653574, 48874.94643292502, 32088.186833793072,
             25325.224241180662, 20883.19550608641, 17220.29587545702, 13590.916083988539, 10820.914346982809,
             11916.319307657188, 14836.10153746372, 19130.480940161266, 22400.29857475091, 27645.49468036512,
             36919.761194694365, 43230.15593055365, 55256.80713848612, 70012.83520386124, 83429.52999235924,
             101175.68236992316, 109481.33929224772, 130461.45972363789, 152760.1767800979, 177309.07512986133,
             190190.06079621578, 215024.18470158757, 226636.54935904406, 260761.61060971924, 277263.9467800957,
             39950.55735988475, 34419.29974700787, 29914.953001619982, 24027.614743718015, 15913.900917493676,
             12782.005049265259]
        self.testModel_Beam_Energies_45deg, self.testModel_Beam_Flux_45deg = helperFuncs().removeDuplicates(self.testModel_Beam_Energies_45deg, self.testModel_Beam_Flux_45deg)
        self.testModel_Beam_Energies_45deg, self.testModel_Beam_Flux_45deg = zip(*sorted(zip(self.testModel_Beam_Energies_45deg, self.testModel_Beam_Flux_45deg)))

    def generate_SecondariesCurve(self):
        return CubicSpline(np.array(self.Energy_secondaries), np.array(self.NFlux_up_PeriE_secondaries))

    def generate_BackScatterCurve(self, E_Incident):
        return CubicSpline(np.array(self.Energy_BackScatter)*E_Incident, (10000/E_Incident)*np.array(self.NFlux_up_PeriE_BackScatter))

    #####################
    # --- DIAGNOSTICS ---
    #####################
    def integrate_SecondariesCurve(self):
        # Evans reported 0.1, we report 0.10935158
        R = simpson(x= self.Energy_secondaries,y= self.NFlux_up_PeriE_secondaries)
        return R

    def integrate_DegradedPrimaryCurve(self):
        # Evans reported this value to be 0.46. Our value is 0.42248456
        return simpson(x= np.array(self.Energy_DegradedPrimary),y= 10000*np.array(self.NFlux_up_PeriE_DegradedPrimary))















